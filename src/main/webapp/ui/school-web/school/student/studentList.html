<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>学员管理列表</title>
    <link href="../../layui/css/layui.css" rel="stylesheet">
    <link href="css/layuiAdmin.css" rel="stylesheet">
    <link href="../../static/css/style.css" rel="stylesheet">
    <script src="../../static/js/jquery.min.js"></script>
    <script src="../../layui/layui.js"></script>
    <script src="../../static/js/base.js"></script>
    <script src="../../static/js/ax.js"></script>
    <script src="../../static/js/jquery.cookie.js"></script>

</head>
<body>
<!--当前位置-->
<div class="layui-fluid position">
    <div class="layui-row">
        <p class="layui-col-xs6">
            <span class="layui-breadcrumb" lay-separator=">"><a><cite class="t">您当前的位置</cite></a><a href="">首页</a><a><cite>学员管理列表</cite></a></span>
        </p>
        <p class="layui-col-xs6">2017年10月12日 14:11:42 星期四</p>
    </div>
</div>
<!--当前位置-->


<!--主体内容-->
<div class="layui-fluid content">
    <div class="layui-card">
        <!--查询-->
        <div class="layui-form layui-card-header layuiadmin-card-header-auto">
            <div class="layui-form-item layui-row">
                <div class="layui-inline layui-col-md3 layui-col-sm6">
                    <label class="layui-form-label">学员列表</label>
                    <div class="layui-input-block">
                        <input type="text" id="NameOrNum" placeholder="请输入学员姓名或证件号码" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-inline layui-col-md3 layui-col-sm6">
                    <label class="layui-form-label">报名机构</label>
                    <div class="layui-input-block">
                        <input type="text"  id="driverName" placeholder="请输入报名机构" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-inline layui-col-md3 layui-col-sm6">
                    <label class="layui-form-label">手机号码</label>
                    <div class="layui-input-block">
                        <input type="text" id="phone" placeholder="请输入手机号码" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-inline layui-col-md3 layui-col-sm6">
                    <label class="layui-form-label">准驾车型</label>
                    <div class="layui-input-block">
                        <select name="sex">
                            <option value="0">不限</option>
                            <option value="1">c1</option>
                            <option value="2">c2</option>
                        </select>
                    </div>
                </div>

                <div class="layui-inline layui-col-md3 layui-col-sm6">
                    <label class="layui-form-label">互联网状态</label>
                    <div class="layui-input-block">
                        <select name="sex">
                            <option value="0">未提交</option>
                            <option value="1">待提交</option>
                            <option value="2">已发送</option>
                        </select>
                    </div>
                </div>

                <div class="layui-inline layui-col-md3 layui-col-sm6">
                    <label class="layui-form-label">业务状态</label>
                    <div class="layui-input-block">
                        <select name="sex">
                            <option value="0">办结</option>
                            <option value="1">退办</option>
                            <option value="2">全部</option>
                        </select>
                    </div>
                </div>

                <div class="layui-inline layui-col-md3 layui-col-sm6">
                    <label class="layui-form-label">时间类型</label>
                    <div class="layui-input-block">
                        <select name="sex">
                            <option value="0">创建时间</option>
                            <option value="1">提交时间</option>
                            <option value="2">报名日期</option>
                        </select>
                    </div>
                </div>

                <div class="layui-inline layui-col-md3 layui-col-sm6">
                    <label class="layui-form-label">开始时间起</label>
                    <div class="layui-input-block">
                        <input type="text" class="layui-input" id="test1">
                    </div>
                </div>

                <div class="layui-inline layui-col-md3 layui-col-sm6">
                    <label class="layui-form-label">结束时间至</label>
                    <div class="layui-input-block">
                        <input type="text" class="layui-input" id="">
                    </div>
                </div>

                <div class="layui-inline layui-col-md3 layui-col-sm6">
                    <label class="layui-form-label">证件类型</label>
                    <div class="layui-input-block">
                        <select name="sex">
                            <option value="0">全部</option>
                            <option value="1">身份证</option>
                            <option value="2">户口本</option>
                        </select>
                    </div>
                </div>


                <div class="layui-inline layui-col-md3 layui-col-sm6">
                    <label class="layui-form-label">学员状态</label>
                    <div class="layui-input-block">
                        <select name="sex">
                            <option value="0">全部</option>
                            <option value="1">新报名</option>
                            <option value="2">在培</option>
                            <option value="3">已结业</option>
                            <option value="4">预警</option>
                        </select>
                    </div>
                </div>

                <div class="layui-inline layui-col-md3 layui-col-sm6">
                    <button id="show" class="layui-btn right-btn" data-type="reload">搜索</button>
                </div>
            </div>
        </div>


        <!--数据列表展示-->
        <div class="layui-card-body">
            <script type="text/html" id="toolbarDemo">
                <div>
                    <button class="layui-btn layuiadmin-btn-useradmin ax-btn" lay-event="addStudent" >学员录入</button>
                    <button class="layui-btn layuiadmin-btn-useradmin ax-btn" lay-event="addDriver" >增驾</button>
                    <button class="layui-btn layuiadmin-btn-useradmin ax-btn" lay-event="updateStudet" >编辑</button>
                    <button class="layui-btn layuiadmin-btn-useradmin ax-btn" lay-event="submit122">批量提交122</button>
                    <button class="layui-btn layuiadmin-btn-useradmin ax-btn" lay-event="del">删除</button>
                    <button class="layui-btn layuiadmin-btn-useradmin ax-btn" lay-event="export">导出excel</button>
                </div>
            </script>

            <table class="layui-hide" id="activeListTbale"
                   lay-filter="active"></table>
        </div>


    </div>
</div>
<!--主体内容-->

</body>

<script>

    //当前位置
    $('.content').css('padding-top',$('.position').innerHeight()+18);
    $(window).resize(function(){
        $('.content').css('padding-top',$('.position').innerHeight()+18);
    });
    layui.use('element', function(){
        var element = layui.element;

        //…
    });

    var table;

    layui.use(['table','form','laydate','layer'], function() {
        table = layui.table;
        var form = layui.form,
            laydate = layui.laydate,
            layer=layui.layer;

        //常规用法
        laydate.render({
            elem: '#activeTime'
            ,range: true
        });

        var tableIns = ax.VTable({
            elem : '#activeListTbale',
            url : '/api/student/getStudentAll',
            id: 'testReload',
            toolbar: '#toolbarDemo',
            title:'学员数据列表',
            cols : [ [ {
                type : 'checkbox',
                fixed : 'left'
            }, {
                field : 'id',
                width : 80,
                title : '序号',
                sort : true,
                fixed : 'left'
            }, {
                field : 'title',
                title : '学员编号',
                minWidth : 150,
                fixed : 'left'
            }, {
                field : 'driversId',
                width : 80,
                title : '报名机构',
                sort : true
            }, {
                field : 'name',
                width : 80,
                title : '姓名',
                sort : true
            }, {
                field : 'certificatesNumber',
                width : 80,
                title : '证件号码',
                sort : true
            }, {
                field : 'state',
                width : 80,
                title : '证件类型',
                templet: '#stateTpl'
            }, {
                field : 'registeredSource',
                width : 120,
                title : '来源'
            }, {
                field : 'carId',
                width : 180,
                title : '准驾车型',
                sort : true
            }, {
                field : 'updateTime',
                width : 180,
                title : '驾校名称',
                sort : true
            }, {
                field : 'netStatusName',
                width : 180,
                title : '互联网状态',
                sort : true
            }, {
                field : 'innerStatusName',
                width : 180,
                title : '业务状态',
                sort : true
            }, {
                field : 'isBindingWechatName',
                width : 180,
                title : '是否微信绑定',
                sort : true
            },{
                field : 'wechatOpenid',
                width : 180,
                title : '微信号',
                sort : true
            },{
                field : 'created',
                width : 180,
                title : '创建时间',
                sort : true
            },
                {
                    fixed : 'right',
                    width : 180,
                    title : '操作',
                    toolbar : '#barDemo'
                } ] ]

        });

        var $ = layui.$,student = {
            reload : function() {

                var NameOrNum = $('#NameOrNum').val();
                // var activeType = $('#activeType').val();
                // var activeTag = $('#activeTag').val();
                // var activeTime = $('#activeTime').val();

                //执行重载
                table.reload('testReload', {
                    page : {
                        curr: 1 //重新从第 1 页开始
                    },
                    where : {
                        name : NameOrNum,

                    }
                });
            },
            reloadClean:function()
            {
                $('#NameOrNum').val('');
                // $('#activeType').val("");
                // $('#activeTag').val('');
                // $('#activeTime').val('');
                // $("#selectedvalue").val('');
                form.render('select');//重新加载select
                table.reload('testReload');
            }
        };


        $('#show').on('click', function(){
            var type = $(this).data('type');//获取reload
            student[type] ? student[type].call(this) : '';
        });


        //头工具栏事件
        table.on('toolbar()', function(obj){
            var checkStatus = table.checkStatus(obj.config.id);
            switch(obj.event){
                case 'del':
                    var data = checkStatus.data;
                    if(data.length<=0)
                    {
                        layer.open({
                            title: '信息提示'
                            ,content: '请选择删除的数据！'
                        });
                        break;
                    }
                    layer.confirm('确定是否需要删除学员！', function (index) {
                        var ids = [];
                        for (var i = 0; i < data.length; i++) {
                            ids.push(data[i].id);
                        }
                        delStudent(ids);
                    })

                    break;
                case 'addStudent':

                    addStudent();
                    break;
                case 'isAll':
                    layer.msg(checkStatus.isAll ? '全选': '未全选');
                    break;
            };
        });

    });


    //删除用户
    function delStudent(ids)
    {
        var data={ids:ids};
        ax.get({
            url:"/api/student/del",
            data:data,
            success:function (res) {
                parent.layer.msg("删除成功");
            },
            error : function(request) {
                parent.layer.msg("系统错误，联系管理员");
            }
        });
    }


    function  addStudent() {

        var  perContent =  layer.open({
            type: 2
            ,title: '学员录入'
            ,shade: 0
            ,anim: 0
            ,content: 'addStudent.html'
            ,yes: function(){
                $(that).click();
            }
            ,btn2: function(){
                layer.closeAll();
            }
        });
        layer.full(perContent);
    }



</script>
</html>